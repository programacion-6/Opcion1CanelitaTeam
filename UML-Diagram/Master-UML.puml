@startuml LibraryManagementSystem
package "Library system"{
    ' Define modules
    !include UserSystem.puml
    !include ReportSystem.puml
    !include BorrowSystem.puml
    !include BookSystem.puml
    !include SearchSystem.puml
    !include FineSystem.puml
    !include UI.puml
    !include StatisticSystem.puml
    !include ReturnSystem.puml

    ' Define classes

    class Library {
        - PatronManager patronManager
        - StaffManager staffManager
        - BorrowManager borrowManager
        - BookManager bookManager
        - FinesManager FinesManager
        + InitializeProgram()
    }

    ' Define relationships
    Library ..* PatronManager
    Library ..* StaffManager
    Library ..* BorrowManager
    Library ..* BookManager
    Library ..* FineManager
    FineManager ..* Fine
    Statistics ..* BorrowManager
    PatronSearch ..* PatronManager
    BookSearch ..* BookManager
    Borrow ..* Book
    Borrow ..* PatronConcrete
    BorrowManager ..* Borrow
    UserCreator ..> User
    Library ..> HomePageMenu
    HomePageMenu ..> Login
    Login ..> PatronMenu
    PatronMenu ..> PatronSearchMenu
    PatronMenu ..> PatronBorrowMenu
    PatronMenu ..> ReturnContext : uses
    PatronMenu *.. PatronReturnMenu : has
    StaffMenu ..> BookStaffManagement
    StaffMenu ..> ReportStaffMenu
    StaffMenu ..> StaffSearchMenu
    Login ..> StaffMenu
    ABorrowReport ..* BorrowManager
    APatronReport ..* PatronManager
    PatronManager ..* PatronConcrete
    StaffManager ..* StaffConcrete
    BookManager ..* Book
    PatronSearchMenu ..> MenuGenerator
    PatronBorrowMenu ..> MenuGenerator
    ReportStaffMenu ..> MenuGenerator
    StaffSearchMenu ..> MenuGenerator
    BookStaffManagement ..> MenuGenerator
    PatronMenu ..> MenuGenerator
    StaffMenu ..> MenuGenerator
    PerformPatronSearch ..> PatronSearch
    PerformBookSearch ..> BookSearch
    PatronSearchMenu ..> PerformBookSearch
    StaffSearchMenu ..> PerformBookSearch
    StaffSearchMenu ..> PerformPatronSearch
    Statistic ..> StatisticReport
    ReportStaffMenu ..> Statistic
    ReturnContext o-- Borrow
    ReturnContext o-- Fine
}
@enduml
